<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Fingerprint Processor Studio</title>
  <link rel="stylesheet" href="./style.css">
</head>
<body>
  <div class="background-shapes"></div>
  <div class="page">
    <header class="hero">
      <div>
        <p class="eyebrow">Realtime lab console</p>
        <h1>Fingerprint Processor Studio</h1>
        <p class="lede">
          Drop fingerprint images, let the enhancement pipeline run, and download sharpened results without touching a terminal.
        </p>
        <div class="hero-actions">
          <a class="button ghost" href="/docs" target="_blank" rel="noopener">Open API docs</a>
          <button class="button subtle" id="refreshOutputs">Refresh output folders</button>
        </div>
        <div class="badge-row">
          <span class="pill">CLAHE + sharpening</span>
          <span class="pill">Celery + Redis queue</span>
          <span class="pill">Batch aware</span>
        </div>
      </div>
      <div class="hero-card">
        <div class="hero-card__title">Pipeline snapshot</div>
        <ul>
          <li><span>1</span>Upload fingerprints (supports JPG, PNG, BMP, TIF)</li>
          <li><span>2</span>Queue job via FastAPI → Celery worker</li>
          <li><span>3</span>CLAHE + sharpening + noise control</li>
          <li><span>4</span>Download originals + enhanced outputs</li>
        </ul>
      </div>
    </header>

    <main class="grid">
      <section class="panel">
        <div class="panel__header">
          <div>
            <p class="eyebrow">Upload & enhance</p>
            <h2>Queue a job</h2>
            <p class="hint">Files stay on this host; polling will start automatically.</p>
          </div>
        </div>

        <form id="uploadForm" class="form">
          <div id="dropzone" class="dropzone">
            <div class="dropzone__icon">⬢</div>
            <div>
              <p class="dropzone__title">Drop files here or click to select</p>
              <p class="hint">Up to many files at once. Allowed: jpg, jpeg, png, bmp, tiff, tif.</p>
            </div>
            <input id="fileInput" type="file" name="files" multiple accept=".jpg,.jpeg,.png,.bmp,.tif,.tiff">
          </div>

          <div class="form-grid">
            <label class="field">
              <span>Output folder</span>
              <input type="text" id="outputFolder" name="output_folder" value="processed_images" placeholder="processed_images">
            </label>
            <label class="field">
              <span>Filename prefix</span>
              <input type="text" id="filenamePrefix" name="filename_prefix" value="enhanced" placeholder="enhanced">
            </label>
          </div>

          <div class="actions">
            <button type="submit" class="button primary" id="submitBtn">Start processing</button>
            <div class="hint">We will poll status every few seconds until the worker finishes.</div>
          </div>
        </form>
        <div id="uploadMessage" class="message"></div>
      </section>

      <section class="panel">
        <div class="panel__header">
          <div>
            <p class="eyebrow">Job tracker</p>
            <h2>Status & results</h2>
          </div>
          <button class="button subtle" id="stopPolling" type="button">Stop polling</button>
        </div>

        <div id="statusCard" class="status-card">
          <p class="hint">No job yet. Upload files to start.</p>
        </div>

        <div class="lookup">
          <label class="field">
            <span>Lookup job ID</span>
            <div class="lookup__row">
              <input type="text" id="lookupJobId" placeholder="Paste a job id (UUID)">
              <button class="button ghost" id="lookupBtn" type="button">Check</button>
            </div>
          </label>
        </div>

        <div id="resultsCard" class="results"></div>
      </section>

      <section class="panel wide">
        <div class="panel__header">
          <div>
            <p class="eyebrow">Storage</p>
            <h2>Output folders</h2>
            <p class="hint">Lists on-disk output folders that match processed/batch/enhanced prefixes.</p>
          </div>
          <button class="button subtle" id="refreshOutputsSecondary" type="button">Refresh</button>
        </div>
        <div id="outputsList" class="outputs"></div>
      </section>
    </main>
  </div>

  <script src="./app.js"></script>
</body>
</html>
